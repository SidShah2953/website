---
import { getCollection, type CollectionEntry } from "astro:content";
import Layout from "@/layouts/Layout.astro";
import ContentPage from "@/components/ContentPage.astro";

export async function getStaticPaths() {
  const research = await getCollection("research");
  return research
    .filter(r => r.data.isPublished)
    .map(r => ({ params: { slug: r.slug }, props: { entry: r } }));
}

type Props = {
  entry: CollectionEntry<"research">;
};

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<Layout
  title={`${entry.data.title} | Research`}
  description={entry.data.description}
>
  {import.meta.env.PROD && <script slot="head" data-goatcounter="https://siddhants.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>}

  <ContentPage type="research" entry={entry} Content={Content} />
</Layout>
